<!DOCTYPE html>
<html>
<head>
	<style>
		body, canvas {
			margin: 0;
			padding: 0;
			overflow: hidden;
		}

		form {
		position: absolute;
      max-width: 400px;
      margin: 0 auto;
      background-color: #ffffff;
      padding: 20px;
      border: 1px solid #dddddd;
      border-radius: 4px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }

    label {
      display: block;
      margin-bottom: 10px;
      font-weight: bold;
    }

    input[type="text"] {
      width: 100%;
      padding: 8px;
      font-size: 14px;
      border: 1px solid #dddddd;
      border-radius: 4px;
    }

    input[type="button"] {
      display: block;
      width: 100%;
      padding: 10px;
      background-color: #4caf50;
      color: #ffffff;
      font-size: 16px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }

    input[type="button"]:hover {
      background-color: #45a049;
    }
	</style>
	<title>Math Tricks</title>
	<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=0">
	<meta charset="UTF-8"></meta> <!-- allows for cyrillic and other exotic text in console.logs -->
</head>

<body onload="init()">
	<form id="myForm">
		<label for="textfield1">Field width(in x):</label>
		<input type="text" id="textfield1" name="textfield1" required><br><br>
	
		<label for="textfield2">Field height(in y):</label>
		<input type="text" id="textfield2" name="textfield2" required><br><br>
	
		<input type="button" value="GO!" onclick="submitForm()">
	  </form>
 	
	<canvas id="canvas-id" width=window.innerWidth height=window.innerHeight></canvas>
	<script>
		var gameStart = false
		function submitForm() {
      var textField1 = document.getElementById("textfield1").value;
      var textField2 = document.getElementById("textfield2").value;
      console.log("Field width(in x): " + textField1);
      console.log("Field height(in y): " + textField2);
	  if (!/^\d+$/.test(textField1) || !/^\d+$/.test(textField2)) {
        alert("Please enter valid numbers without decimal places.");
        return;
      }
	  fieldWidth = textField1;
	  fieldHeight = textField2;
	  gameStart = true
	  var formElement = document.getElementById("myForm");
      formElement.parentNode.removeChild(formElement);
    }
		function areColliding(Ax, Ay, Awidth, Aheight, Bx, By, Bwidth, Bheight) {
			if (Bx <= Ax + Awidth) {
				if (Ax <= Bx + Bwidth) {
					if (By <= Ay + Aheight) {
						if (Ay <= By + Bheight) {
							return 1;
						}
					}
				}
			}
			return 0;
		};

		function randomInteger(upTo){
			return Math.floor(Math.random()*upTo);
		}

		function drawLine(startX, startY, endX, endY) {
			// For better performance bunch calls to lineTo WITHOUT beginPath() and stroke() inbetween.
			context.beginPath(); // resets the current path
			context.moveTo(startX, startY);
			context.lineTo(endX, endY);
			context.stroke();
		}

		function tryToLoad(imageNameWithoutDotPng, backupColor) {
			return tryToLoadWithFullPath(imageNameWithoutDotPng + '.png', backupColor);
		}

		function tryToLoadWithFullPath(imageNameAndPath, backupColor) {
			return {
				img   : new Image(),
				src   : "images/" + imageNameAndPath,
				color : backupColor,
				needed: false // flag letting know drawImage to request the actual image if ever used
			};
		}

		function drawImage(img, x, y, xs, ys) {
			if(img == null) {
				// invalid image
				console.error('Tried to draw invalid image');
				return;
			}

			if(img.needed !== true) {
				img.needed = true;
				img.img.src = img.src;
			}

			try {
				if (xs != null) context.drawImage(img.img, x, y, xs, ys);
				else            context.drawImage(img.img, x, y);
			} catch(e) {
				context.fillStyle = img.color;
				if(xs == null) {
					xs = 100;
					ys = 100;
				}
				context.fillRect(x, y, xs, ys);
			}
		}


		let endlessCanvas = false;
		let updateTime = 10; // in ms

		const canvas = document.getElementById("canvas-id");
		const context = canvas.getContext("2d");
		context.fillStyle = "#0000ff";
		// global variables with mouse coordinates
		let mouseX = 0;
		let mouseY = 0;
		// some keycodes
		let key_left = 37;
		let key_up = 38;
		let key_right = 39;
		let key_down = 40;
		let key_a = 65;
		let key_z = 90;
		let isKeyPressed = [];
		for (i = 0; i < 256; ++i) {
			isKeyPressed.push(0);
		}
		// gridSize = 50; // uncomment or add to game.js if you want a grid
		const reqAnimationFrame = window.requestAnimationFrame || window.mozRequestAnimationFrame || window.webkitRequestAnimationFrame || window.msRequestAnimationFrame || function (callback) {
			setTimeout(callback, 1000 / 30);
		};
		function redraw() {
			context.clearRect(0, 0, canvas.width, canvas.height);
			draw(); // call progammer's draw() function
			context.globalAlpha = 1;
			// draw grid
			//context.fillStyle = "#FF0000";
			context.font = "10px Arial";
			if (typeof gridSize != "undefined" && gridSize >= 25) {
				context.fillText(0, 4, 10);
				context.beginPath();
				for(i = gridSize;i < canvas.width;i += gridSize) {
					context.moveTo(i, 0);
					context.lineTo(i, canvas.height);
					context.fillText(i, i + 4, 10);
				}
				for(i = gridSize;i < canvas.height;i += gridSize) {
					context.moveTo(0, i);
					context.lineTo(canvas.width, i);
					context.fillText(i, 4, i + 10);
				}
				context.stroke();
			}

			reqAnimationFrame(redraw);
		};

		function init() {
			if (endlessCanvas) {
				canvas.width = window.innerWidth;
				canvas.height = window.innerHeight;
				window.onresize = function () {
					canvas.width = window.innerWidth;
					canvas.height = window.innerHeight;
				};
			} else {
				canvas.width = window.innerWidth;
				canvas.height = window.innerHeight;
			}
			if ('ontouchstart' in window || navigator.maxTouchPoints) {
				isMobile = true;
				window.addEventListener("touchstart", function (e) {
					let touchobj = e.changedTouches[0];
					mouseX = parseInt(touchobj.pageX - canvas.offsetLeft);
					mouseY = parseInt(touchobj.pageY - canvas.offsetTop);
					mousedown();
				});
				window.addEventListener("touchend", function (e) {
					let touchobj = e.changedTouches[0];
					mouseX = parseInt(touchobj.pageX - canvas.offsetLeft);
					mouseY = parseInt(touchobj.pageY - canvas.offsetTop);
					mouseup();
				});
				window.addEventListener("touchmove", function (e) {
					let touchobj = e.changedTouches[0];
					mouseX = parseInt(touchobj.pageX - canvas.offsetLeft);
					mouseY = parseInt(touchobj.pageY - canvas.offsetTop);
				});
			}
			window.addEventListener("mousemove", function (e) {
				mouseX = e.pageX - canvas.offsetLeft;
				mouseY = e.pageY - canvas.offsetTop;
			});
			if(typeof mousemove != "undefined") {
				window.addEventListener("mousemove", mousemove);
			}
			if(typeof mouseup != "undefined") {
				window.addEventListener("mouseup", mouseup);
			}
			if(typeof mousedown != "undefined") {
				window.addEventListener("mousedown", mousedown);
			}
			if(typeof keydown != "undefined") {
				window.addEventListener("keydown", function (e) {
					isKeyPressed[e.keyCode] = 1;
					keydown(e.keyCode);
				});
			} else {
				window.addEventListener("keydown", function (e) {
					isKeyPressed[e.keyCode] = 1;
				});
			}
			if(typeof keyup != "undefined") {
				window.addEventListener("keyup", function (e) {
					isKeyPressed[e.keyCode] = 0;
					keyup(e.keyCode);
				});
			} else {
				window.addEventListener("keyup", function (e) {
					isKeyPressed[e.keyCode] = 0;
				});
			}
			if(typeof draw == "undefined") {
				redraw = function () {
					context.clearRect(0, 0, canvas.width, canvas.height);
					context.globalAlpha = 1;
					context.fillStyle = "#FF0000";
					context.font = "20px Arial";
					context.fillText("Press <F12> for error info!", 40, 40);
				};
			}
			redraw();
			setInterval(update, updateTime);
		}
		</script>

		<!-- user's game file -->
		<script src="./game.js"></script>
</body>

</html>
